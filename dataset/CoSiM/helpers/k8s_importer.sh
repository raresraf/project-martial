#!/bin/bash

# Define the repository URL
REPO_URL="https://github.com/kubernetes/kubernetes"

# Define the base path for your folders
BASE_FOLDER_PATH="/Users/raf/code/project-martial/dataset/CoSiM/raw"

# Define your lists of commit SHAs and UIDs
# Commit SHAs - replace with your actual list of SHAs
COMMIT_SHAS=(
  "786a0c6294273f5df950f61d2fa74abc9cc1b73b"
  "de37da853237e2de586fd653e37388cad96a195e"
  "086ab4291aa9e594a54bbab29b04c1d7e7c84193"
  "a959ae636ba7dc8d748e4787e4426121c1c6d500"
  "e87fa5e0ffadf4b1437fd34cb2691d0035c392f7"
  "e3ea0b1cbbaec8f78ab3401e56be16dcd9c5067c"
  "35d0af9243cb38e44bcd932db96746a848c441a8"
  "c44f5467a22c3d4e5ccbc5fc3e8c89e5102f105c"
  "bed9b2f23be40429d9c228592c52ae40f75a896d"
  "d6522e0e742a494ce2f5032ee295953dd830643f"
  "8b79fe3ebe6d60a3fb2c74525b41464cdb7f60ee"
  "629718ef0b138dc2e340ae7f07a661bbccb6a2fd"
  "3592c1be18e56c960cbc384778046d28f539f64c"
  "c84c27b6ac797347cf03c6776c86327c33a36908"
  "3786cfdf855b46044a33de5622452825ad86816b"
  "1fd959e256f7925f055ebbe19c3e7858f2cada42"
  "42cfda2f946aad3c366eb825153456ac285bb4f6"
  "185ba08fcd5b046c167ee1a808a2d149c922f9ee"
  "518c502f544cda70f8d821ee7006031038b953f6"
  "becc4b7d57fe8d2b120d8c4576c4dae588316f7e"
  "20b1597302a42184636e3e46c6c6fbe33f047d98"
  "367a683273342654d84c94f57cbd09c549ac535f"
  "56b9daf50f12fb56c6ab3961f4820f2b35020c02"
  "f5b6f794102fb5fee0ae8378fc75d006336e5f1a"
  "b602ddf90147fa6beb13c5d611cf76d113351f93"
  "ed48ed0122c7289f458a6bc3ac616319d5c17e91"
  "510aa1b432499f752fbacb2abf7e19f73311cdad"
  "5360db5df819a4cac101410bb0e192104a24e242"
  "59e757afef07beb17e26c02eade097d031cb49c7"
  "d55d6175f8e2cfdab0b79aac72046a652c2eb515"
  "968adfa99362f733ef82f4aabb34a59dbbd6e56a"
  "178a8f87f313fd38969c2a1f07963e24e45238ff"
  "000510d9b73d5be870ebc763ea3606997107172c"
  "1f91fffb575b4e8155145a68cd3a23d806655353"
  "40da2c521ac5a3e4708b3b90c5711f83344c8ae8"
  "5d10dcd9836622db9235e3ccac1924c3947ed32c"
  "32766e3b6daac0d1a9653b4877a086ae3ae979ac"
  "d27ad5b7143995de2cf61315d86d9fb0c57e0ba5"
  "5ba4f836f8e40a33624f6a0351b51976c93dabf8"
  "06c5be98028d6c045ae438498b46262ea1035b9c"
  "c69df736ee54154c04860f3cafd46d82b0fc89ff"
  "97368fc0f2a98cc2a8fdfa4133b96301274774e3"
  "4b26ef22177eb54122e1345dfe2ee7030760725f"
  "d288bc0368975df69940a105bc44d9f7783cc511"
  "1a11a1886f47267f0be90186f42f60280449a5e1"
  "5f08555f457ac7ed8396e915e8c4d41a55e6539b"
  "0acc56a10d13642556ccf544a31f47b4e5f6f50a"
  "6dfe5b4b5a6c8eb50ebdab151af10e5fea6c4519"
  "8e55220523f086243e1a92cfe436e9b0bdc5bad0"
  "52713cd837131936229cb25834fa90c3ef909105"
)

# UIDs - ensure this list has at least twice the number of entries as COMMIT_SHAS
# (one for old_folder_name and one for new_folder_name per iteration)
UIDS=(
"706a7ab9-c3b6-41e7-b050-4d97ebd9e6ea"
"717a318d-2bb4-4f73-af71-cd249896ccab"
"206f575d-26f4-405e-99af-d493ee7bdacd"
"671f9985-18f3-4366-bfc3-748b1b640126"
"cda52b29-2a6b-4dfa-9e37-2269b42c2d97"
"13c978a5-8b60-4a8e-8b2b-cbac9e44271a"
"2c2eecda-43dd-4b44-afa8-7156e40e7d12"
"d4aede55-3ceb-43ee-b973-e7016254e4a9"
"35e6de48-dfab-4b27-8d80-4c49fdc0174d"
"a43ff4ee-4013-4b24-b13f-6e970b643bc6"
"686a237c-03f7-47a0-9def-96a7eefb3b63"
"cbc66013-22ae-47ec-9061-907e39aee592"
"ab627b08-ee7d-46de-9e66-386af857c1be"
"cf88bb19-59c8-4ae6-a993-ca9e816f9dd6"
"bbc51444-17b8-4eba-80e8-cee43d55faa1"
"c4f29b99-4fc3-4385-9189-6d22b5bcf222"
"60cd71c4-c901-4f44-8cc2-8c1386687ea9"
"1d77b55a-1638-4435-a380-ab4cdbf0fd42"
"cec274f0-268b-4863-a033-bec74912c4b6"
"fcf63181-ba36-4f75-ab97-49e004bed427"
"742e9b77-2d96-4d08-b6a2-0e8086371b92"
"f6f60492-5179-4c1e-8724-8fa48aceeb4f"
"5512c61c-32b1-4650-b42b-b3cd71e0826b"
"c679bc6c-5082-4306-8d15-6662f3a01e57"
"b753ba96-ad67-4469-8648-b5367fa125eb"
"6f3cc88f-6a72-4bbe-b77c-633afe293601"
"6c0c910c-321f-475a-9a40-b4894e7dbd3f"
"4a7e52ee-cfa2-4079-bf8c-7dc1bed87bb6"
"3e1af822-6a93-4646-8177-1b7844570358"
"606dbf3d-7ca2-4c7c-8b41-ddcca133ce9a"
"f4aae56f-5d43-4284-aa5a-e7bccf5fb8cb"
"a17e4762-e0b3-435b-8475-8bc30e2431d5"
"99b26846-86a6-4253-b5a2-eedb6c08a353"
"cd492621-0bfd-4825-953a-5f56f8c39e2c"
"9c6e7442-0b8d-4e8a-8eb8-20cce34e53a4"
"758c8352-f8a6-4223-aeed-6f8485449064"
"08531ff6-024d-4ed1-b742-d97990e71187"
"0d93c5b2-ba33-4e6a-b25c-3ed8c219d95c"
"e9d0b3fa-da7b-4139-8f56-6b566234d993"
"6d0b435b-a35f-4979-bc5a-6c9e73a8350c"
"8f744555-b451-4307-a667-de75c1ed94f4"
"6422fd48-a13a-44dc-b1d9-8077ec0ff6b8"
"bcfc7f3c-28f7-4806-8a2d-41adf7cf8ef4"
"7d46e0b6-fc08-4aab-b09b-74b1cacfe02c"
"359a69fa-18d8-4dce-9bc7-e673635e606e"
"236451b3-42c4-43f8-9e6d-a3dd37dc2baa"
"5a73b919-179c-45f4-9c56-009fef6fcf51"
"6dd6611e-2b05-410b-aae5-267273591491"
"56d523b8-caba-4024-b7c8-f83599f79cf8"
"0ab85a66-81f1-4001-9961-4592a6d41de6"
"10116502-bfdd-4062-a908-22e3f7b4f743"
"6dcb79e5-8986-4dd2-a895-55e1775ff99d"
"cd4cadd7-8131-44ba-ae6e-dbc1641cb52a"
"531b45dc-9329-455a-9d34-7ee6de5f582a"
"c8d4f193-5974-4c80-9f5a-38e9c99fb923"
"d86e7637-918b-4d3b-af54-05cc0d13d25a"
"cbdbebb1-70e5-42d5-9001-359df80cc58a"
"1afefef7-1a09-4e24-ab0d-b9d1dbfe6248"
"9405dff7-187b-4034-8f90-bfc980fe3d45"
"fde757fc-98bc-4481-b735-ac0bb3f61bed"
"7f0771bd-80b1-4f21-a53b-43a254abd428"
"27f35243-4795-4870-a500-166caa55ecb4"
"b19415a0-6733-4640-a4cf-89d5037d7a8f"
"0dd6fa14-0c3b-4883-9cca-01f33f821cec"
"e2d6a176-46e4-47df-991c-678437c31460"
"182ee51f-9780-4479-bcda-f7504aa99a9d"
"15fcef5d-d2eb-4871-8399-35e06f6d28cc"
"78ac9b70-e370-48d1-9f3c-68bc402a2bf9"
"6477f8d1-ed36-4fa8-ad46-ac841a471ef1"
"87ca6172-b014-4e9f-a1f7-619089b4c5a4"
"1ebd75ac-a080-4162-85d9-bb5773e9ad55"
"0b670637-4b7d-44f7-97db-fbe74130d8ee"
"9303d3a5-0567-4697-aef5-536b01dd0d61"
"25dfe362-074a-4e50-9f1e-2c72652f73cd"
"d8bcbd74-e518-4b65-8081-1bf725d1a4aa"
"d65fe618-eeda-47e6-8293-f26543ed6a27"
"d4a461be-efee-48dc-a0c3-264d885033a0"
"4de8d5a8-df0e-497f-bc91-79b51d15da0e"
"f7fb7d20-3e3e-459e-8601-1817342a0c03"
"979ba99e-fdea-481e-8696-a270e19b7014"
"3af65048-12a7-406f-ae32-077fc1ff2d84"
"1b621409-8bbc-4fd6-9f0b-d831af77fc31"
"4fe81396-04fa-4562-ad10-211888493a83"
"22c52aac-61b6-4834-a21e-376490fab8a2"
"722255a4-c699-44b6-be05-9d3b8ee18062"
"f7394fcc-f33b-45d2-8ff1-7a6dd232f43e"
"9c05352d-bce9-4957-a06d-b1c6a4bef602"
"59634eb5-c846-462d-b509-e541538f8e65"
"0237bcb2-ee95-4514-9288-7f9013de8716"
"d341b621-04ac-4002-8dde-6fb4983197a1"
"887f95f3-d3aa-403b-beb3-6d4d2ddb6c57"
"3e10dd7e-05b3-4f41-9378-5312a8ceb9fb"
"fb816893-9ceb-4729-9abe-98df976841e9"
"a9302803-aa58-4be0-b28f-96b8417b3c85"
"679cd4f4-2bfe-41b7-b608-0759812ea76c"
"59f2c4f4-4745-477a-a821-3fcc1eda455c"
"893caf85-ee0a-4454-a81d-277995f141e4"
"b55eb00c-7f4c-4a55-b00c-53cbdd5db711"
"1b5c2046-299c-4659-94a5-c8a15d8a5c05"
"a39d34d9-962a-4916-8d33-4109fdf5cdd8"
)

# Check if there are enough UIDs for the operations
if [ ${#UIDS[@]} -lt $(( ${#COMMIT_SHAS[@]} * 2 )) ]; then
  echo "Error: Not enough UIDs provided for all commit SHAs."
  echo "You need at least $(( ${#COMMIT_SHAS[@]} * 2 )) UIDs, but only ${#UIDS[@]} were provided."
  exit 1
fi

# Loop through each commit SHA
for i in "${!COMMIT_SHAS[@]}"; do
  COMMIT_SHA="${COMMIT_SHAS[$i]}"
  
  # Calculate the indices for UIDs
  OLD_UID_INDEX=$(( i * 2 ))
  NEW_UID_INDEX=$(( i * 2 + 1 ))

  # Get the UIDs for the current iteration
  OLD_FOLDER_UID="${UIDS[$OLD_UID_INDEX]}"
  NEW_FOLDER_UID="${UIDS[$NEW_UID_INDEX]}"

  # Construct the full folder paths
  OLD_FOLDER_NAME="${BASE_FOLDER_PATH}/${OLD_FOLDER_UID}"
  NEW_FOLDER_NAME="${BASE_FOLDER_PATH}/${NEW_FOLDER_UID}"

  echo "Running with:"
  echo "  Commit SHA: ${COMMIT_SHA}"
  echo "  Old Folder: ${OLD_FOLDER_NAME}"
  echo "  New Folder: ${NEW_FOLDER_NAME}"
  echo "---"

  # Execute the python script
  python3 github_importer.py \
    --repo_url="${REPO_URL}" \
    --commit_sha="${COMMIT_SHA}" \
    --old_folder_name="${OLD_FOLDER_NAME}" \
    --new_folder_name="${NEW_FOLDER_NAME}"
done